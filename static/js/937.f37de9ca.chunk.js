"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[937],{8937:(e,s,t)=>{t.r(s),t.d(s,{default:()=>u});var n=t(5043);const r="ChatPage_chat_page__eh6GC";var l=t(9781),a=t(579);const d=()=>{const[e,s]=(0,n.useState)(null);return(0,n.useEffect)((()=>{let e;const t=()=>{setTimeout(n,3e3)};function n(){var n,r,l;null===(n=e)||void 0===n||n.removeEventListener("close",t),null===(r=e)||void 0===r||r.close(),e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),null===(l=e)||void 0===l||l.addEventListener("close",t),s(e)}return n(),()=>{e.removeEventListener("close",t),e.close()}}),[]),(0,a.jsxs)("div",{children:[(0,a.jsx)(i,{ws:e}),(0,a.jsx)(c,{ws:e})]})},i=e=>{let{ws:s}=e;const[t,r]=(0,n.useState)([]);return(0,n.useEffect)((()=>{const e=e=>{let s=JSON.parse(e.data);r((e=>[...e,...s]))};return null===s||void 0===s||s.addEventListener("message",e),()=>{null===s||void 0===s||s.removeEventListener("message",e)}}),[s]),(0,a.jsx)("div",{style:{height:"400px",overflowY:"auto"},children:t.map(((e,s)=>(0,a.jsx)("div",{children:(0,a.jsx)(o,{message:e})},s)))})},o=e=>{let{message:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("img",{src:s.photo,alt:""}),(0,a.jsx)("b",{children:s.userName}),(0,a.jsx)("br",{}),s.message,(0,a.jsx)("hr",{})]})},c=e=>{let{ws:s}=e;const[t,r]=(0,n.useState)(""),[d,i]=(0,n.useState)("pending");(0,n.useEffect)((()=>{let e=()=>{i("ready")};return null===s||void 0===s||s.addEventListener("open",e),()=>{null===s||void 0===s||s.removeEventListener("open",e)}}),[s]);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)("textarea",{onChange:e=>r(e.currentTarget.value),value:t})}),(0,a.jsx)("div",{children:(0,a.jsx)(l.$,{disabled:!s||"ready"!==d,onClick:()=>{t&&(null===s||void 0===s||s.send(t),r(""))},children:"Send"})})]})},u=()=>(0,a.jsx)("div",{className:r,children:(0,a.jsx)(d,{})})}}]);
//# sourceMappingURL=937.f37de9ca.chunk.js.map